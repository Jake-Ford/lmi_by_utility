add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
env_df <- st_read("data/CA/enviro_screen/CES4 Final Shapefile.shp")
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/CES4 Final Shapefile.shp") %>%
filter(ClscoreP >= 75)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(ClscoreP >= 75)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
table(env_df$CIscoreP)
View(env_df)
temp <- env_df %>% filter(Tract == 6015000202)
View(temp)
temp$CIscoreP
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE) %>%
group_by(GEOID)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2021,
geometry=TRUE)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2018,
geometry=TRUE)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2020,
geometry=TRUE)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
env_df <- st_as_sf(env_df, st_crs(ny_tracts))
st_crs(env_df)
leaflet() %>%
addPolygons(data=env_df)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75)
View(env_df)
env_df$geometry
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
View(env_df)
typeof(env_df$Tract)
typeof(ca_tracts$GEOID)
View(ca_tracts)
ca_tracts$test <- as.double(ca_tracts$GEOID)
env_df <- merge(ca_tracts, env_df, by.x = 'temp_geo', by.y = 'Tract')
ca_tracts$temp_geo <- as.double(ca_tracts$GEOID)
env_df <- merge(ca_tracts, env_df, by.x = 'temp_geo', by.y = 'Tract')
View(env_df)
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$temp_geo <- as.double(ca_tracts$GEOID)
env_df <- merge(env_df, ca_tracts, by.x = 'temp_geo', by.y = 'Tract')
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_df <- merge(env_df, ca_tracts, by=c("Tract"))
env_df <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_df <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE)
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE)
env_df$geometry
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
# filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE)
View(env_geo)
View(env_geo)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP )
View(env_geo)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP, geometry )
View(env_geo)
leaflet() %>%
addPolygons(data=env_geo)
st_crs(env_geo)
env_geo <- st_as_sf(env_geo, st_crs(ca_tracts)) %>%
st_make_valid
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP, geometry)
env_geo <- st_as_sf(env_geo, st_crs(ca_tracts)) %>%
st_make_valid
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
# filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.y=TRUE) %>%
select(GEOID,CIscoreP, geometry)
env_geo <- st_as_sf(env_geo, st_crs(ca_tracts)) %>%
st_make_valid
View(env_geo)
temp <- st_as_sf(env_geo)
st_crs(temp)
env_geo <- st_as_sf(env_geo) %>%
st_make_valid(
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.y=TRUE) %>%
select(GEOID,CIscoreP, geometry)
env_geo <- st_as_sf(env_geo) %>%
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
# filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP, geometry)
env_geo <- st_as_sf(env_geo) %>%
st_make_valid()
st_crs(env_geo)
leaflet() %>%
addPolygons(data=env_geo)
leaflet() %>%
addPolygons(env_geo)
leaflet() %>%
addPolygons(data=ca_tracts)
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
leaflet() %>%
addPolygons(data=env_geo)
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
# filter(CIscoreP >= 75) %>%
st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP, geometry)
env_geo <- st_as_sf(env_geo) %>%
st_make_valid()
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
leaflet() %>%
addPolygons(data=env_geo)
print(st_crs(env_geo))
print(st_crs(ca_tracts))
chas_df <- load_chas() %>%
mutate(State_Name = case_when(
state == 17 ~ "Illinois",
state == 25 ~ "Massachusetts",
state == 27 ~ "Minnesota",
state == 34 ~ "New Jersey",
state == 35 ~ "New Mexico",
state == 36 ~ "New York",
state == 06 ~ "California",
TRUE ~ "Other"
))
add_geo <- merge(chas_df, get_tracts)
add_geo <- st_as_sf(add_geo)
add_geo <- add_geo %>%
filter(State_Name=="California")
# CalEnviroScreen Data Download
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") #%>%
# filter(CIscoreP >= 75) %>%
# st_drop_geometry()
ca_tracts <- get_acs(
geography="tract",
state="CA",
variables=c("Total_Pop" = "B01001_001"
),
year=2019,
geometry=TRUE)
ca_tracts$Tract <- as.double(ca_tracts$GEOID)
env_geo <- merge(env_df, ca_tracts, by=c("Tract"), all.x=TRUE) %>%
select(GEOID,CIscoreP, geometry)
st_crs(env_df)
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
st_crs(env_geo)
leaflet() %>%
addPolygons(data=env_geo)
View(env_geo)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") #%>%
# filter(CIscoreP >= 75) %
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
leaflet() %>%
addPolygons(data=env_geo)
leaflet() %>%
addPolygons(data = env_geo)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
leaflet() %>%
addPolygons(data = env_geo)
library(sf)
library(leaflet)
# Load the shapefile
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
# Check the first few rows of the loaded data
head(env_df)
# Check geometry type and validity
print(st_geometry_type(env_df))
print(st_is_valid(env_df))
# Transform the geometry
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
# Create a basic leaflet map
leaflet() %>%
addPolygons(data = env_df)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_geo <- st_transform(env_geo, st_crs(ca_tracts))
leaflet() %>%
addPolygons(data = env_geo)
library(sf)
library(leaflet)
# Load the shapefile
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
# Check the first few rows of the loaded data
head(env_df)
# Check geometry type and validity
print(st_geometry_type(env_df))
print(st_is_valid(env_df))
# Transform the geometry
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
# Create a basic leaflet map
leaflet() %>%
addPolygons(data = env_df)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp") %>%
filter(CIscoreP >= 75)
env_d$CIscoreP
summary(env_df$CIscoreP)
env_df <- env_df %>%
filter(env_df$CIscoreP >= 75)
View(env_df)
env_df$TotPop19
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- env_df %>%
filter(env_df$CIscoreP >= 75)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
leaflet() %>%
addPolygons(data = env_df)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
leaflet() %>%
addPolygons(data = env_df,
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP,
))
leaflet() %>%
addPolygons(data = env_df,
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
pal <- colorNumeric(
palette = "Reds",
domain = env_df$CIscoreP
)
leaflet() %>%
addPolygons(data = env_df,
color = ~pal(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
typeof(env_df$CIscoreP)
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
pal <- colorNumeric(
palette = "viridis",
domain = env_df$CIscoreP
)
leaflet() %>%
addPolygons(data = env_df,
# color = ~pal(CIscoreP),
stroke=FALSE,
smoothFactor=0.2,
fillOpacity=0.7,
color=~pal3(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
leaflet() %>%
addPolygons(data = env_df,
# color = ~pal(CIscoreP),
stroke=FALSE,
smoothFactor=0.2,
fillOpacity=0.7,
color=~pal(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
pal <- colorNumeric(
palette = "viridis",
domain = env_df$CIscoreP,
reverse = TRUE
)
leaflet() %>%
addPolygons(data = env_df,
# color = ~pal(CIscoreP),
stroke=FALSE,
smoothFactor=0.2,
fillOpacity=0.7,
color=~pal(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
env_df %>%
leaflet() %>%
addPolygons(
# color = ~pal(CIscoreP),
stroke=FALSE,
smoothFactor=0.2,
fillOpacity=0.7,
color=~pal(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
env_df <- st_read("/Users/jacobford/Downloads/calenviroscreen40shpf2021shp/CES4 Final Shapefile.shp")
env_df <- st_transform(env_df, crs = st_crs(ca_tracts))
pal <- colorNumeric(
palette = "viridis",
domain = env_df$CIscoreP[env_df$CIscoreP >=75],
reverse = TRUE
)
env_df %>%
filter(CIscoreP >= 75) %>%
leaflet() %>%
addPolygons(
# color = ~pal(CIscoreP),
stroke=FALSE,
smoothFactor=0.2,
fillOpacity=0.7,
color=~pal(CIscoreP),
popup = paste("GEOID: ", env_df$Tract, "<br>",
"Total Population: ", env_df$TotPop19, "<br>",
"EnviroScreen 4.0 Score: ", env_df$CIscore, "<br>",
"EnviroScreen 4.0 Score Percentile: ", env_df$CIscoreP
))
temp <- env_df %>% filter(CIscoreP > 75)
temp <- env_df %>% filter(CIscoreP > 75.0)
